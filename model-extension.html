<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Custom Renderer</title>

  <!-- BPMN 스타일 CDN -->
  <link rel="stylesheet" href="https://unpkg.com/bpmn-js-properties-panel@0.37.1/dist/assets/bpmn-js-properties-panel.css" />
  <link rel="stylesheet" href="https://unpkg.com/bpmn-js@13.1.0/dist/assets/bpmn-font/css/bpmn-embedded.css" />
  <link rel="stylesheet" href="https://unpkg.com/bpmn-js@13.1.0/dist/assets/diagram-js.css" />
  <link rel="stylesheet" href="https://unpkg.com/bpmn-js-properties-panel@1.26.0/dist/assets/properties-panel.css" />

  <style>
    html, body, #canvas {
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
</head>
<body>
  <div id="canvas"></div>

  <!-- BPMN JS -->
  <!-- <script src="./vendor/bpmn-js/assets/bpmn-modeler-v11.5.0.js"></script> -->
  <script src="./vendor/bpmn-js/assets/bpmn-modeler-v18.6.2.js"></script>

  <script>

    const camundaModdle = {
      "name": "Camunda",
      "uri": "http://camunda.org/schema/1.0/bpmn",
      "prefix": "camunda",
      "xml": {
        "tagAlias": "lowerCase"
      },
      "associations": [],
      "types": [
        {
          "name": "Definitions",
          "isAbstract": true,
          "extends": [
            "bpmn:Definitions"
          ],
          "properties": [
            {
              "name": "diagramRelationId",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "InOutBinding",
          "superClass": [
            "Element"
          ],
          "isAbstract": true,
          "properties": [
            {
              "name": "source",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "sourceExpression",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "target",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "businessKey",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "local",
              "isAttr": true,
              "type": "Boolean",
              "default": false
            },
            {
              "name": "variables",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "In",
          "superClass": [
            "InOutBinding"
          ],
          "meta": {
            "allowedIn": [
              "bpmn:CallActivity",
              "bpmn:SignalEventDefinition"
            ]
          }
        },
        {
          "name": "Out",
          "superClass": [
            "InOutBinding"
          ],
          "meta": {
            "allowedIn": [
              "bpmn:CallActivity"
            ]
          }
        },
        {
          "name": "AsyncCapable",
          "isAbstract": true,
          "extends": [
            "bpmn:Activity",
            "bpmn:Gateway",
            "bpmn:Event"
          ],
          "properties": [
            {
              "name": "async",
              "isAttr": true,
              "type": "Boolean",
              "default": false
            },
            {
              "name": "asyncBefore",
              "isAttr": true,
              "type": "Boolean",
              "default": false
            },
            {
              "name": "asyncAfter",
              "isAttr": true,
              "type": "Boolean",
              "default": false
            },
            {
              "name": "exclusive",
              "isAttr": true,
              "type": "Boolean",
              "default": true
            }
          ]
        },
        {
          "name": "JobPriorized",
          "isAbstract": true,
          "extends": [
            "bpmn:Process",
            "camunda:AsyncCapable"
          ],
          "properties": [
            {
              "name": "jobPriority",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "SignalEventDefinitionExtension",
          "isAbstract": true,
          "extends": [
            "bpmn:SignalEventDefinition"
          ],
          "properties": [
            {
              "name": "async",
              "isAttr": true,
              "type": "Boolean",
              "default": false
            }
          ]
        },
        {
          "name": "ErrorEventDefinitionExtension",
          "isAbstract": true,
          "extends": [
            "bpmn:ErrorEventDefinition"
          ],
          "properties": [
            {
              "name": "errorCodeVariable",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "errorMessageVariable",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "ErrorEventDefinition",
          "superClass": [
            "bpmn:ErrorEventDefinition",
            "Element"
          ],
          "properties": [
            {
              "name": "expression",
              "isAttr": true,
              "type": "String"
            }
          ],
          "meta": {
            "allowedIn": [ "bpmn:ServiceTask" ]
          }
        },
        {
          "name": "Error",
          "isAbstract": true,
          "extends": [
            "bpmn:Error"
          ],
          "properties": [
            {
              "name": "camunda:errorMessage",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "PotentialStarter",
          "superClass": [
            "Element"
          ],
          "properties": [
            {
              "name": "resourceAssignmentExpression",
              "type": "bpmn:ResourceAssignmentExpression"
            }
          ]
        },
        {
          "name": "FormSupported",
          "isAbstract": true,
          "extends": [
            "bpmn:StartEvent",
            "bpmn:UserTask"
          ],
          "properties": [
            {
              "name": "formHandlerClass",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "formKey",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "formRef",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "formRefBinding",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "formRefVersion",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "TemplateSupported",
          "isAbstract": true,
          "extends": [
            "bpmn:Collaboration",
            "bpmn:Process",
            "bpmn:FlowElement"
          ],
          "properties": [
            {
              "name": "modelerTemplate",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "modelerTemplateVersion",
              "isAttr": true,
              "type": "Integer"
            }
          ]
        },
        {
          "name": "Initiator",
          "isAbstract": true,
          "extends": [ "bpmn:StartEvent" ],
          "properties": [
            {
              "name": "initiator",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "ScriptTask",
          "isAbstract": true,
          "extends": [
            "bpmn:ScriptTask"
          ],
          "properties": [
            {
              "name": "resultVariable",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "resource",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "Process",
          "isAbstract": true,
          "extends": [
            "bpmn:Process"
          ],
          "properties": [
            {
              "name": "candidateStarterGroups",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "candidateStarterUsers",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "versionTag",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "historyTimeToLive",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "isStartableInTasklist",
              "isAttr": true,
              "type": "Boolean",
              "default": true
            }
          ]
        },
        {
          "name": "EscalationEventDefinitionExtension",
          "isAbstract": true,
          "extends": [
            "bpmn:EscalationEventDefinition"
          ],
          "properties": [
            {
              "name": "escalationCodeVariable",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "FormalExpression",
          "isAbstract": true,
          "extends": [
            "bpmn:FormalExpression"
          ],
          "properties": [
            {
              "name": "resource",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "Assignable",
          "extends": [ "bpmn:UserTask" ],
          "properties": [
            {
              "name": "assignee",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "candidateUsers",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "candidateGroups",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "dueDate",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "followUpDate",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "priority",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "CallActivity",
          "extends": [ "bpmn:CallActivity" ],
          "properties": [
            {
              "name": "calledElementBinding",
              "isAttr": true,
              "type": "String",
              "default": "latest"
            },
            {
              "name": "calledElementVersion",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "calledElementVersionTag",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "calledElementTenantId",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "caseRef",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "caseBinding",
              "isAttr": true,
              "type": "String",
              "default": "latest"
            },
            {
              "name": "caseVersion",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "caseTenantId",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "variableMappingClass",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "variableMappingDelegateExpression",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "ServiceTaskLike",
          "extends": [
            "bpmn:ServiceTask",
            "bpmn:BusinessRuleTask",
            "bpmn:SendTask",
            "bpmn:MessageEventDefinition"
          ],
          "properties": [
            {
              "name": "expression",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "class",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "delegateExpression",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "resultVariable",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "DmnCapable",
          "extends": [
            "bpmn:BusinessRuleTask"
          ],
          "properties": [
            {
              "name": "decisionRef",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "decisionRefBinding",
              "isAttr": true,
              "type": "String",
              "default": "latest"
            },
            {
              "name": "decisionRefVersion",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "mapDecisionResult",
              "isAttr": true,
              "type": "String",
              "default": "resultList"
            },
            {
              "name": "decisionRefTenantId",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "ExternalCapable",
          "extends": [
            "camunda:ServiceTaskLike"
          ],
          "properties": [
            {
              "name": "type",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "topic",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "TaskPriorized",
          "extends": [
            "bpmn:Process",
            "camunda:ExternalCapable"
          ],
          "properties": [
            {
              "name": "taskPriority",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "Properties",
          "superClass": [
            "Element"
          ],
          "meta": {
            "allowedIn": [ "*" ]
          },
          "properties": [
            {
              "name": "values",
              "type": "Property",
              "isMany": true
            }
          ]
        },
        {
          "name": "Property",
          "superClass": [
            "Element"
          ],
          "properties": [
            {
              "name": "id",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "name",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "value",
              "type": "String",
              "isAttr": true
            }
          ]
        },
        {
          "name": "Connector",
          "superClass": [
            "Element"
          ],
          "meta": {
            "allowedIn": [
              "camunda:ServiceTaskLike"
            ]
          },
          "properties": [
            {
              "name": "inputOutput",
              "type": "InputOutput"
            },
            {
              "name": "connectorId",
              "type": "String"
            }
          ]
        },
        {
          "name": "InputOutput",
          "superClass": [
            "Element"
          ],
          "meta": {
            "allowedIn": [
              "bpmn:FlowNode",
              "camunda:Connector"
            ]
          },
          "properties": [
            {
              "name": "inputOutput",
              "type": "InputOutput"
            },
            {
              "name": "connectorId",
              "type": "String"
            },
            {
              "name": "inputParameters",
              "isMany": true,
              "type": "InputParameter"
            },
            {
              "name": "outputParameters",
              "isMany": true,
              "type": "OutputParameter"
            }
          ]
        },
        {
          "name": "InputOutputParameter",
          "properties": [
            {
              "name": "name",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "value",
              "isBody": true,
              "type": "String"
            },
            {
              "name": "definition",
              "type": "InputOutputParameterDefinition"
            }
          ]
        },
        {
          "name": "InputOutputParameterDefinition",
          "isAbstract": true
        },
        {
          "name": "List",
          "superClass": [ "InputOutputParameterDefinition" ],
          "properties": [
            {
              "name": "items",
              "isMany": true,
              "type": "InputOutputParameterDefinition"
            }
          ]
        },
        {
          "name": "Map",
          "superClass": [ "InputOutputParameterDefinition" ],
          "properties": [
            {
              "name": "entries",
              "isMany": true,
              "type": "Entry"
            }
          ]
        },
        {
          "name": "Entry",
          "properties": [
            {
              "name": "key",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "value",
              "isBody": true,
              "type": "String"
            },
            {
              "name": "definition",
              "type": "InputOutputParameterDefinition"
            }
          ]
        },
        {
          "name": "Value",
          "superClass": [
            "InputOutputParameterDefinition"
          ],
          "properties": [
            {
              "name": "id",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "name",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "value",
              "isBody": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "Script",
          "superClass": [ "InputOutputParameterDefinition" ],
          "properties": [
            {
              "name": "scriptFormat",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "resource",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "value",
              "isBody": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "Field",
          "superClass": [ "Element" ],
          "meta": {
            "allowedIn": [
              "camunda:ServiceTaskLike",
              "camunda:ExecutionListener",
              "camunda:TaskListener"
            ]
          },
          "properties": [
            {
              "name": "name",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "expression",
              "type": "String"
            },
            {
              "name": "stringValue",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "string",
              "type": "String"
            }
          ]
        },
        {
          "name": "InputParameter",
          "superClass": [ "InputOutputParameter" ]
        },
        {
          "name": "OutputParameter",
          "superClass": [ "InputOutputParameter" ]
        },
        {
          "name": "Collectable",
          "isAbstract": true,
          "extends": [ "bpmn:MultiInstanceLoopCharacteristics" ],
          "superClass": [ "camunda:AsyncCapable" ],
          "properties": [
            {
              "name": "collection",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "elementVariable",
              "isAttr": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "FailedJobRetryTimeCycle",
          "superClass": [ "Element" ],
          "meta": {
            "allowedIn": [
              "camunda:AsyncCapable",
              "bpmn:MultiInstanceLoopCharacteristics"
            ]
          },
          "properties": [
            {
              "name": "body",
              "isBody": true,
              "type": "String"
            }
          ]
        },
        {
          "name": "ExecutionListener",
          "superClass": [ "Element" ],
          "meta": {
            "allowedIn": [
              "bpmn:Task",
              "bpmn:ServiceTask",
              "bpmn:UserTask",
              "bpmn:BusinessRuleTask",
              "bpmn:ScriptTask",
              "bpmn:ReceiveTask",
              "bpmn:ManualTask",
              "bpmn:ExclusiveGateway",
              "bpmn:SequenceFlow",
              "bpmn:ParallelGateway",
              "bpmn:InclusiveGateway",
              "bpmn:EventBasedGateway",
              "bpmn:StartEvent",
              "bpmn:IntermediateCatchEvent",
              "bpmn:IntermediateThrowEvent",
              "bpmn:EndEvent",
              "bpmn:BoundaryEvent",
              "bpmn:CallActivity",
              "bpmn:SubProcess",
              "bpmn:Process"
            ]
          },
          "properties": [
            {
              "name": "expression",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "class",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "delegateExpression",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "event",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "script",
              "type": "Script"
            },
            {
              "name": "fields",
              "type": "Field",
              "isMany": true
            }
          ]
        },
        {
          "name": "TaskListener",
          "superClass": [ "Element" ],
          "meta": {
            "allowedIn": [
              "bpmn:UserTask"
            ]
          },
          "properties": [
            {
              "name": "expression",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "class",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "delegateExpression",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "event",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "script",
              "type": "Script"
            },
            {
              "name": "fields",
              "type": "Field",
              "isMany": true
            },
            {
              "name": "id",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "eventDefinitions",
              "type": "bpmn:TimerEventDefinition",
              "isMany": true
            }
          ]
        },
        {
          "name": "FormProperty",
          "superClass": [ "Element" ],
          "meta": {
            "allowedIn": [
              "bpmn:StartEvent",
              "bpmn:UserTask"
            ]
          },
          "properties": [
            {
              "name": "id",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "name",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "type",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "required",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "readable",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "writable",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "variable",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "expression",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "datePattern",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "default",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "values",
              "type": "Value",
              "isMany": true
            }
          ]
        },
        {
          "name": "FormData",
          "superClass": [ "Element" ],
          "meta": {
            "allowedIn": [
              "bpmn:StartEvent",
              "bpmn:UserTask"
            ]
          },
          "properties": [
            {
              "name": "fields",
              "type": "FormField",
              "isMany": true
            },
            {
              "name": "businessKey",
              "type": "String",
              "isAttr": true
            }
          ]
        },
        {
          "name": "FormField",
          "superClass": [ "Element" ],
          "properties": [
            {
              "name": "id",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "label",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "type",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "datePattern",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "defaultValue",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "properties",
              "type": "Properties"
            },
            {
              "name": "validation",
              "type": "Validation"
            },
            {
              "name": "values",
              "type": "Value",
              "isMany": true
            }
          ]
        },
        {
          "name": "Validation",
          "superClass": [ "Element" ],
          "properties": [
            {
              "name": "constraints",
              "type": "Constraint",
              "isMany": true
            }
          ]
        },
        {
          "name": "Constraint",
          "superClass": [ "Element" ],
          "properties": [
            {
              "name": "name",
              "type": "String",
              "isAttr": true
            },
            {
              "name": "config",
              "type": "String",
              "isAttr": true
            }
          ]
        },
        {
          "name": "ConditionalEventDefinitionExtension",
          "isAbstract": true,
          "extends": [
            "bpmn:ConditionalEventDefinition"
          ],
          "properties": [
            {
              "name": "variableName",
              "isAttr": true,
              "type": "String"
            },
            {
              "name": "variableEvents",
              "isAttr": true,
              "type": "String"
            }
          ]
        }
      ],
      "emumerations": [ ]
    };
    const customModdle = {
      name: "custom",
      uri: "http://example.com/custom",
      prefix: "custom",
      xml: {
        tagAlias: "lowerCase"
      },
      types: [
        {
          name: "CustomConnector",
          superClass: ["bpmn:BaseElement"],
          properties: [
            {
              name: "url",
              isAttr: true,
              type: "String"
            },
            {
              name: "method",
              isAttr: true,
              type: "String"
            }
          ]
        }
      ]
    };

    const xml = `<?xml version="1.0" encoding="UTF-8"?>
<bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:qa="http://some-company/schema/bpmn/qa" id="_RdgBELNaEeSYkoSLDs6j-w" targetNamespace="http://activiti.org/bpmn">
  <bpmn2:process id="Process_1">
    <bpmn2:task id="Task_1" name="Examine Situation" qa:suitable="70">
      <bpmn2:outgoing>SequenceFlow_1</bpmn2:outgoing>
      <bpmn2:extensionElements>
        <qa:analysisDetails lastChecked="2019-03-27T13:59:37.098Z" nextCheck="2019-03-28T13:59:37.098Z">
          <qa:comment author="Klaus">
            Our operators always have a hard time to figure out, what they need to do here.
          </qa:comment>
          <qa:comment author="Walter">
            I believe this can be split up in a number of activities and partly automated.
          </qa:comment>
        </qa:analysisDetails>
      </bpmn2:extensionElements>
    </bpmn2:task>
    <bpmn2:sequenceFlow id="SequenceFlow_1" name="" sourceRef="Task_1" targetRef="ExclusiveGateway_1"/>
    <bpmn2:exclusiveGateway id="ExclusiveGateway_1" name="Things OK?">
      <bpmn2:incoming>SequenceFlow_1</bpmn2:incoming>
      <bpmn2:outgoing>SequenceFlow_2</bpmn2:outgoing>
      <bpmn2:outgoing>SequenceFlow_5</bpmn2:outgoing>
    </bpmn2:exclusiveGateway>
    <bpmn2:sequenceFlow id="SequenceFlow_2" name="" sourceRef="ExclusiveGateway_1" targetRef="EndEvent_1"/>
    <bpmn2:sequenceFlow id="SequenceFlow_5" name="" sourceRef="ExclusiveGateway_1" targetRef="EndEvent_2"/>
    <bpmn2:endEvent id="EndEvent_1" name="Notification Sent">
      <bpmn2:incoming>SequenceFlow_2</bpmn2:incoming>
      <bpmn2:messageEventDefinition id="MessageEventDefinition_1"/>
    </bpmn2:endEvent>
    <bpmn2:endEvent id="EndEvent_2" name="Error Propagated">
      <bpmn2:incoming>SequenceFlow_5</bpmn2:incoming>
      <bpmn2:errorEventDefinition id="ErrorEventDefinition_1"/>
    </bpmn2:endEvent>
  </bpmn2:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1">
      <bpmndi:BPMNShape id="_BPMNShape_Task_2" bpmnElement="Task_1">
        <dc:Bounds height="80.0" width="100.0" x="96.0" y="196.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_EndEvent_2" bpmnElement="EndEvent_1">
        <dc:Bounds height="36.0" width="36.0" x="396.0" y="300.0"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="0.0" width="0.0" x="414.0" y="341.0"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_ExclusiveGateway_2" bpmnElement="ExclusiveGateway_1" isMarkerVisible="true">
        <dc:Bounds height="50.0" width="50.0" x="276.0" y="210.0"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="21.0" width="74.0" x="333.0" y="226.0"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="BPMNEdge_SequenceFlow_1" bpmnElement="SequenceFlow_1" sourceElement="_BPMNShape_Task_2" targetElement="_BPMNShape_ExclusiveGateway_2">
        <di:waypoint xsi:type="dc:Point" x="196.0" y="236.0"/>
        <di:waypoint xsi:type="dc:Point" x="276.0" y="235.0"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="6.0" width="6.0" x="214.0" y="236.0"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_SequenceFlow_2" bpmnElement="SequenceFlow_2" sourceElement="_BPMNShape_ExclusiveGateway_2" targetElement="_BPMNShape_EndEvent_2">
        <di:waypoint xsi:type="dc:Point" x="301.0" y="260.0"/>
        <di:waypoint xsi:type="dc:Point" x="301.0" y="318.0"/>
        <di:waypoint xsi:type="dc:Point" x="396.0" y="318.0"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="6.0" width="6.0" x="298.0" y="301.0"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="_BPMNShape_EndEvent_3" bpmnElement="EndEvent_2">
        <dc:Bounds height="36.0" width="36.0" x="396.0" y="132.0"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="0.0" width="0.0" x="414.0" y="173.0"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="BPMNEdge_SequenceFlow_5" bpmnElement="SequenceFlow_5" sourceElement="_BPMNShape_ExclusiveGateway_2" targetElement="_BPMNShape_EndEvent_3">
        <di:waypoint xsi:type="dc:Point" x="301.0" y="210.0"/>
        <di:waypoint xsi:type="dc:Point" x="301.0" y="150.0"/>
        <di:waypoint xsi:type="dc:Point" x="396.0" y="150.0"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="6.0" width="6.0" x="333.0" y="150.0"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn2:definitions>
`;

    class CustomRenderer {
      constructor(eventBus, styles) {
        this._eventBus = eventBus;
        this._styles = styles;

        eventBus.on('render.shape', 2000, (event) => {
          // alert(2)
          const { element, gfx } = event;
          if (element.type === 'bpmn:Task') {
            this.drawCustomTask(gfx, element);
            event.stopPropagation();
          }
        });
      }

      drawCustomTask(parentNode, element) {
        const SVG_NS = 'http://www.w3.org/2000/svg';
        const width = element.width || 100;
        const height = element.height || 80;

        // 사각형 생성
        const rect = document.createElementNS(SVG_NS, 'rect');
        rect.setAttribute('width', width);
        rect.setAttribute('height', height);
        rect.setAttribute('rx', 10);
        rect.setAttribute('ry', 10);
        rect.setAttribute('fill', '#ffd700');
        rect.setAttribute('stroke', '#333');
        rect.setAttribute('stroke-width', 2);
        parentNode.appendChild(rect);

        // 텍스트 생성
        const text = document.createElementNS(SVG_NS, 'text');
        text.textContent = 'Job Proc';
        text.setAttribute('x', width / 2);
        text.setAttribute('y', height / 2 + 5);
        text.setAttribute('text-anchor', 'middle');
        text.setAttribute('font-size', '12px');
        text.setAttribute('font-weight', 'bold');
        parentNode.appendChild(text);
      }
    }

    CustomRenderer.$inject = ['eventBus', 'styles'];

    const customRendererModule = {
      __init__: ['customRenderer'],
      customRenderer: ['type', CustomRenderer]
    };

    const bpmnModeler = new BpmnModeler({
      container: '#canvas',
      additionalModules: [customRendererModule],
      moddleExtensions: {
        custom: customModdle,
        camunda: camundaModdle
      }
    });

    bpmnModeler.importXML(xml).then(() => {
      const canvas = bpmnModeler.get('canvas');

      requestAnimationFrame(() => {
        // 현재 뷰박스 얻기
        const viewbox = canvas.viewbox();

        // 원하는 위치로 이동
        canvas.viewbox({
          x: -100,
          y: 0,
          width: viewbox.width,
          height: viewbox.height
        });
      });
    }).catch(err => {
      console.error('Failed to load BPMN diagram:', err);
    });
  </script>
</body>
</html>
